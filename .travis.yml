language: node_js
node_js:
- node
- 12
cache:
  directories:
  - "~/.npm"
  - ".jest"
before_script:
- npm install -g npm@latest
- npm install -g expo-cli@latest
- echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p
script:
- npm ci
- npx jest --ci
jobs:
  include:
  - stage: deploy
    node_js: lts/*
    script:
    - npm ci
    - npx expo login -u $EXPO_USERNAME -p $EXPO_PASSWORD
    - npx expo publish --release-channel develop --non-interactive
